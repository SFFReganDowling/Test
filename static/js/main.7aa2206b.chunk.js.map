{"version":3,"sources":["ClockCoordinates.js","Temperature.js","WeatherSymbol.js","Display.js","Weather.js","Hand.js","Error.js","Clock.js","App.js","serviceWorker.js","index.js"],"names":["ClockCoordinates","time","hourDx","radius","radians","Math","PI","decimalHour","sin","hourDy","cos","minuteDx","minuteDy","symbolDx","size","symbolDy","isNight","_degreesDistance","d0","d1","distance","abs","rankFreeDirections","degreeCandidates","minuteDegrees","hourDegrees","degreesToRank","forEach","degrees","minDistance","hourDistance","min","sort","degree1","degree2","rank1","rank2","this","constructor","name","TypeError","getHours","getMinutes","DISTANCE_FROM_CENTER","Temperature","render","temperature","props","degreesCelsius","x","coordinates","y","className","React","Component","SIZE","WeatherSymbol","url","symbol","width","height","href","WIND_TEXT_RADIUS","WINDBOX_SCALE","Display","state","textWidth","textHeight","componentDidMount","boundingBox","textRef","current","getBBox","setState","coords","rw","rh","Fragment","rx","ry","ref","dominantBaseline","textAnchor","children","createRef","Weather","renderTemperatures","renderUs","filter","forecast","undefined","celsius","map","timestamp","key","renderWeathers","renderWindAndPrecipitation","precipitation_mm","minWind","maxWind","weather","wind_m_s","round","windString","console","log","locale","navigator","language","userLanguage","precipitationNumberString","Intl","NumberFormat","minimumSignificantDigits","format","precipitationString","bestDegrees","now","windDegrees","windCoords","precipitationDegrees","precipitationCoords","getForecastsToRender","now_ms","getTime","start","Date","end","Object","entries","timestamp_ms","timestamp_date","push","Hand","x1","y1","x2","dx","y2","dy","strokeWidth","cx","cy","r","Error","Dialog","open","onClose","reload","aria-labelledby","aria-describedby","DialogTitle","id","title","DialogContent","DialogContentText","DialogActions","Button","onClick","color","autoFocus","HOUR_HAND_LENGTH","MINUTE_HAND_LENGTH","POSITION_CACHE_MS","FORECAST_CACHE_MS","FORECAST_CACHE_KM","Clock","_getInitialState","geolocation","progress","error","startGeolocationIfNeeded","componentDidUpdate","forecastIsCurrent","download_weather","position","position_age_ms","positionTimestamp","getCurrentPosition","setPosition","geoError","latitude","longitude","getDistanceFromLatLonInKm","lat1","lon1","lat2","lon2","dLat","deg2rad","dLon","a","atan2","sqrt","deg","metadata","forecastMetadata","ageMs","kmDistance","self","fetch","then","response","ok","status","text","weatherXmlString","parseWeatherXml","catch","message","allPrognoses","window","DOMParser","parseFromString","getElementsByTagName","length","forecasts","i","prognosis","from","attributes","value","to","dh","span_h","symbolNodes","symbolNumber","number","celsiusNodes","celsiusValue","parseFloat","windNodes","windValue","mps","precipitationNodes","precipitationValue","location","bind","renderHands","nowCoords","xmlns","version","viewBox","xlinkHref","getClockContents","App","setTimeToNow","type","Boolean","hostname","match","protocol","substring","ReactDOM","document","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.7aa2206b.chunk.js","sourcesContent":["class ClockCoordinates {\n  constructor (time) {\n    if (typeof time === 'number') {\n      this.decimalHour = time\n    } else if (typeof time === 'object' && time.constructor.name === 'Date') {\n      this.decimalHour = time.getHours() + time.getMinutes() / 60.0\n    } else {\n      throw new TypeError('Expected number (decimal hours) or Date')\n    }\n  }\n\n  hourDx = radius => {\n    const radians = 2 * Math.PI * (this.decimalHour / 12.0)\n    return Math.sin(radians) * radius\n  }\n\n  hourDy = radius => {\n    const radians = 2 * Math.PI * (this.decimalHour / 12.0)\n    return -Math.cos(radians) * radius\n  }\n\n  minuteDx = radius => {\n    const radians = 2 * Math.PI * (this.decimalHour % 12.0)\n    return Math.sin(radians) * radius\n  }\n\n  minuteDy = radius => {\n    const radians = 2 * Math.PI * (this.decimalHour % 12.0)\n    return -Math.cos(radians) * radius\n  }\n\n  symbolDx = (radius, size) => {\n    const radians = 2 * Math.PI * (this.decimalHour / 12.0)\n    return Math.sin(radians) * radius - (size - 1) / 2\n  }\n\n  symbolDy = (radius, size) => {\n    const radians = 2 * Math.PI * (this.decimalHour / 12.0)\n    return -Math.cos(radians) * radius - (size - 1) / 2\n  }\n\n  isNight = () => {\n    // FIXME: Actually compute this based on latitude and longitude?\n    return this.decimalHour < 7 || this.decimalHour > 20\n  }\n\n  _degreesDistance = (d0, d1) => {\n    const distance = Math.abs(d1 - d0)\n    if (distance > 180) {\n      return 360 - distance\n    }\n    return distance\n  }\n\n  /**\n   * Return an array of directions (0-360 degrees). The first direction\n   * is the one that is most clear of the clock hands, second one is second\n   * most clear and so on.\n   */\n  rankFreeDirections = () => {\n    const degreeCandidates = [0, 90, 180, 270]\n    const minuteDegrees = 360 * (this.decimalHour % 1.0)\n    const hourDegrees = 360 * ((this.decimalHour % 12.0) / 12.0)\n\n    let degreesToRank = {}\n    degreeCandidates.forEach(degrees => {\n      const minDistance = this._degreesDistance(degrees, minuteDegrees)\n      const hourDistance = this._degreesDistance(degrees, hourDegrees)\n      degreesToRank[degrees] = Math.min(minDistance, hourDistance)\n    })\n\n    degreeCandidates.sort((degree1, degree2) => {\n      const rank1 = degreesToRank[degree1]\n      const rank2 = degreesToRank[degree2]\n      if (rank1 < rank2) {\n        return 1\n      }\n      if (rank1 > rank2) {\n        return -1\n      }\n      return 0\n    })\n\n    return degreeCandidates\n  }\n}\n\nexport default ClockCoordinates\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Temperature.css'\nimport ClockCoordinates from './ClockCoordinates'\n\nconst DISTANCE_FROM_CENTER = 39\n\nclass Temperature extends React.Component {\n  render = () => {\n    // Truncate decimals\n    const temperature = this.props.degreesCelsius | 0\n\n    const x = this.props.coordinates.hourDx(DISTANCE_FROM_CENTER)\n    const y = this.props.coordinates.hourDy(DISTANCE_FROM_CENTER)\n\n    return (\n      <text className='hour' x={x} y={y}>\n        {temperature}&deg;\n      </text>\n    )\n  }\n}\n\nTemperature.propTypes = {\n  degreesCelsius: PropTypes.number,\n  coordinates: PropTypes.instanceOf(ClockCoordinates)\n}\n\nexport default Temperature\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport ClockCoordinates from './ClockCoordinates'\n\nconst DISTANCE_FROM_CENTER = 29\nconst SIZE = 10\n\nclass WeatherSymbol extends React.Component {\n  render = () => {\n    // Note that we *could* download an SVG weather symbol, but that doesn't\n    // work on Firefox 38.0.5 so we do PNG instead. And since cell phone screens\n    // are what we're aiming for, PNG should be fine.\n    const url =\n      'https://api.met.no/weatherapi/weathericon/1.1/?symbol=' +\n      this.props.symbol +\n      ';content_type=image/png;is_night=' +\n      (this.props.coordinates.isNight() ? 1 : 0)\n\n    const x = this.props.coordinates.symbolDx(DISTANCE_FROM_CENTER, SIZE)\n    const y = this.props.coordinates.symbolDy(DISTANCE_FROM_CENTER, SIZE)\n\n    return <image className='symbol' x={x} y={y} width={SIZE} height={SIZE} href={url} />\n  }\n}\n\nWeatherSymbol.propTypes = {\n  coordinates: PropTypes.instanceOf(ClockCoordinates),\n  symbol: PropTypes.string\n}\n\nexport default WeatherSymbol\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Display.css'\n\nimport ClockCoordinates from './ClockCoordinates'\n\nconst WIND_TEXT_RADIUS = 13\nconst WINDBOX_SCALE = 1.2\n\n/**\n * This is supposed to mimic a display on the clock face.\n */\nclass Display extends React.Component {\n  state = {\n    textWidth: 0,\n    textHeight: 0\n  }\n\n  constructor (props) {\n    super(props)\n    this.textRef = React.createRef()\n  }\n\n  componentDidMount = () => {\n    const boundingBox = this.textRef.current.getBBox()\n    this.setState({\n      textWidth: boundingBox.width,\n      textHeight: boundingBox.height\n    })\n  }\n\n  render = () => {\n    const x = this.props.coords.hourDx(WIND_TEXT_RADIUS)\n    const y = this.props.coords.hourDy(WIND_TEXT_RADIUS)\n\n    const rw = this.state.textWidth * WINDBOX_SCALE\n    const rh = this.state.textHeight * WINDBOX_SCALE\n\n    return (\n      <React.Fragment>\n        <rect x={x - rw / 2} y={y - rh / 2} width={rw} height={rh} rx='2' ry='2' className='wind' />\n        <text\n          ref={this.textRef}\n          x={x}\n          y={y}\n          className='wind'\n          dominantBaseline='middle'\n          textAnchor='middle'\n        >\n          {this.props.children}\n        </text>\n      </React.Fragment>\n    )\n  }\n}\n\nDisplay.propTypes = {\n  coordinates: PropTypes.instanceOf(ClockCoordinates)\n}\n\nexport default Display\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Temperature from './Temperature.js'\nimport WeatherSymbol from './WeatherSymbol.js'\nimport Display from './Display.js'\nimport ClockCoordinates from './ClockCoordinates.js'\n\n/**\n * This is what the clock shows after forecasts have been downloaded,\n * up to and including the hour and minute hands.\n */\nclass Weather extends React.Component {\n  renderTemperatures = renderUs => {\n    return renderUs\n      .filter(forecast => forecast.celsius !== undefined)\n      .map(forecast => {\n        const coords = new ClockCoordinates(forecast.timestamp)\n        return (\n          <Temperature\n            key={`hour-${coords.decimalHour}`}\n            coordinates={coords}\n            degreesCelsius={forecast.celsius}\n          />\n        )\n      })\n  }\n\n  renderWeathers = renderUs => {\n    return renderUs\n      .filter(forecast => forecast.symbol !== undefined)\n      .map(forecast => {\n        const coords = new ClockCoordinates(forecast.timestamp)\n\n        return (\n          <WeatherSymbol\n            key={`weather-${coords.decimalHour}`}\n            coordinates={coords}\n            symbol={forecast.symbol}\n          />\n        )\n      })\n  }\n\n  renderWindAndPrecipitation = renderUs => {\n    let precipitation_mm = 0\n    let minWind = null\n    let maxWind = null\n\n    renderUs.forEach(weather => {\n      if (minWind == null || minWind > weather.wind_m_s) {\n        minWind = weather.wind_m_s\n      }\n      if (maxWind == null || maxWind < weather.wind_m_s) {\n        maxWind = weather.wind_m_s\n      }\n      if (weather.precipitation_mm !== undefined) {\n        precipitation_mm += weather.precipitation_mm\n      }\n    })\n\n    minWind = Math.round(minWind)\n    maxWind = Math.round(maxWind)\n    const windString = minWind === maxWind ? `${minWind} m/s` : `${minWind}-${maxWind} m/s`\n    console.log(`Wind: ${windString}`)\n\n    const locale = navigator.language || navigator.userLanguage\n    const precipitationNumberString = new Intl.NumberFormat(locale, {\n      minimumSignificantDigits: 2\n    }).format(precipitation_mm)\n\n    const precipitationString = `${precipitationNumberString}mm`\n    console.log(`Precipitation: ${precipitationString}`)\n\n    const nowCoords = new ClockCoordinates(this.props.now)\n    const bestDegrees = nowCoords.rankFreeDirections()\n\n    // Where do we draw the wind?\n    const windDegrees = bestDegrees[0]\n    const windCoords = new ClockCoordinates((12.0 * windDegrees) / 360.0)\n\n    const precipitationDegrees = bestDegrees[1]\n    const precipitationCoords = new ClockCoordinates((12.0 * precipitationDegrees) / 360.0)\n\n    // FIXME: Render both wind and precipitation in the same display?\n    return (\n      <React.Fragment>\n        <Display coords={windCoords}>{windString}</Display>\n        <Display coords={precipitationCoords}>{precipitationString}</Display>\n      </React.Fragment>\n    )\n  }\n\n  getForecastsToRender = () => {\n    const renderUs = []\n\n    const now_ms = this.props.now.getTime()\n    const start = new Date(now_ms + 0.75 * 3600 * 1000)\n    const end = new Date(now_ms + 11.75 * 3600 * 1000)\n\n    // eslint-disable-next-line\n    for (const [timestamp_ms, forecast] of Object.entries(this.props.forecast)) {\n      const timestamp_date = new Date(timestamp_ms)\n\n      if (timestamp_date < start) {\n        continue\n      }\n\n      if (timestamp_date > end) {\n        continue\n      }\n\n      renderUs.push(forecast)\n    }\n\n    console.log(renderUs)\n    return renderUs\n  }\n\n  render = () => {\n    const renderUs = this.getForecastsToRender()\n    return (\n      <React.Fragment>\n        {this.renderTemperatures(renderUs)}\n        {this.renderWeathers(renderUs)}\n        {this.renderWindAndPrecipitation(renderUs)}\n      </React.Fragment>\n    )\n  }\n}\n\nWeather.propTypes = {\n  forecast: PropTypes.object,\n  now: PropTypes.instanceOf(Date)\n}\n\nexport default Weather\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Hand.css'\n\nclass Hand extends React.Component {\n  // FIXME: Hands should protrude 2 units in the wrong direction as well\n  render = () => {\n    return (\n      <React.Fragment>\n        <line\n          className='hand shadow'\n          x1='0'\n          y1='0'\n          x2={this.props.dx}\n          y2={this.props.dy}\n          strokeWidth={this.props.width}\n        />\n        <circle className='shadow' cx='0' cy='0' r='2' />\n\n        <line\n          className='hand'\n          x1='0'\n          y1='0'\n          x2={this.props.dx}\n          y2={this.props.dy}\n          strokeWidth={this.props.width}\n        />\n        <circle cx='0' cy='0' r='2' />\n      </React.Fragment>\n    )\n  }\n}\n\nHand.propTypes = {\n  width: PropTypes.number,\n  dx: PropTypes.number,\n  dy: PropTypes.number\n}\n\nexport default Hand\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nclass Error extends React.Component {\n  render = () => {\n    // Inspired by: https://material-ui.com/components/dialogs/#alerts\n    return (\n      <Dialog\n        open\n        onClose={this.props.reload}\n        aria-labelledby='alert-dialog-title'\n        aria-describedby='alert-dialog-description'\n      >\n        <DialogTitle id='alert-dialog-title'>{this.props.title}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id='alert-dialog-description'>{this.props.children}</DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={this.props.reload} color='primary' autoFocus>\n            Retry\n          </Button>\n          {/* FIXME: Add button for reporting an issue? */}\n        </DialogActions>\n      </Dialog>\n    )\n  }\n}\n\nError.propTypes = {\n  title: PropTypes.string.isRequired,\n  reload: PropTypes.func.isRequired\n}\n\nexport default Error\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport './Clock.css'\n\nimport Weather from './Weather.js'\nimport Hand from './Hand.js'\nimport Error from './Error.js'\nimport ClockCoordinates from './ClockCoordinates.js'\n\nconst HOUR_HAND_LENGTH = 23\nconst MINUTE_HAND_LENGTH = 34\n\n/** Cache positions for this long */\nconst POSITION_CACHE_MS = 5 * 60 * 1000\n\n/** Cache forecasts for this long */\nconst FORECAST_CACHE_MS = 2 * 60 * 60 * 1000\n\n/** If we move less than this, assume forecast is still valid */\nconst FORECAST_CACHE_KM = 5\n\nclass Clock extends React.Component {\n  constructor (props) {\n    super(props)\n\n    this.state = this._getInitialState()\n  }\n\n  _getInitialState = () => {\n    if (navigator.geolocation) {\n      // FIXME: Invalidate forecast if it's too old (and decide what \"too old\" means)\n      return {\n        now: this.props.now,\n        progress: null,\n        error: null\n      }\n    }\n\n    return {\n      now: this.props.now,\n      progress: null,\n\n      // FIXME: Add a link for contacting me with browser information\n      error: (\n        <Error title='Geolocation unsupported' reload={this.props.reload}>\n          Please try <a href='https://getfirefox.com'>another browser</a>.\n        </Error>\n      )\n    }\n  }\n\n  componentDidMount = () => {\n    this.startGeolocationIfNeeded()\n  }\n\n  componentDidUpdate = () => {\n    if (this.props.now !== this.state.now) {\n      this.setState(this._getInitialState())\n    }\n\n    if (this.startGeolocationIfNeeded()) {\n      // If / when we get the new position, that will in turn trigger a forecast\n      // update, so our work here is done.\n      return\n    }\n\n    if (this.state.progress) {\n      // Something is already happening, don't interrupt it by getting a new forecast\n      return\n    }\n\n    if (this.forecastIsCurrent()) {\n      // Forecast already current, never mind\n      return\n    }\n\n    this.download_weather()\n  }\n\n  startGeolocationIfNeeded = () => {\n    if (this.state.progress) {\n      // Something is already in progress, never mind\n      return false\n    }\n\n    if (this.state.error) {\n      // Something has gone wrong, never mind\n      return false\n    }\n\n    if (this.state.position) {\n      const position_age_ms = new Date() - this.state.positionTimestamp\n\n      if (position_age_ms < POSITION_CACHE_MS) {\n        // Already know where we are, never mind\n        console.log(`Retaining cached position of ${position_age_ms}ms age`)\n        return false\n      }\n    }\n\n    console.log('Geolocating...')\n    this.setState({\n      progress: <text className='progress'>Locating phone...</text>\n    })\n    navigator.geolocation.getCurrentPosition(this.setPosition, this.geoError)\n\n    return true\n  }\n\n  setPosition = position => {\n    const latitude = position.coords.latitude\n    const longitude = position.coords.longitude\n    console.log(`got position: ${latitude} ${longitude}`)\n\n    this.setState({\n      position: position.coords,\n      positionTimestamp: new Date()\n    })\n\n    if (!this.forecastIsCurrent()) {\n      this.download_weather()\n    }\n  }\n\n  // From: https://stackoverflow.com/a/27943/473672\n  getDistanceFromLatLonInKm = (lat1, lon1, lat2, lon2) => {\n    var R = 6371 // Radius of the earth in km\n    var dLat = this.deg2rad(lat2 - lat1)\n    var dLon = this.deg2rad(lon2 - lon1)\n    var a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(this.deg2rad(lat1)) *\n        Math.cos(this.deg2rad(lat2)) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2)\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n    var d = R * c // Distance in km\n    return d\n  }\n\n  deg2rad = deg => {\n    return deg * (Math.PI / 180)\n  }\n\n  forecastIsCurrent = () => {\n    if (!this.state.forecast) {\n      // No forecast at all, that's not current\n      return false\n    }\n\n    const metadata = this.state.forecastMetadata\n    const ageMs = new Date() - metadata.timestamp\n    if (ageMs > FORECAST_CACHE_MS) {\n      // Forecast too old, that's not current\n      return false\n    }\n\n    const kmDistance = this.getDistanceFromLatLonInKm(\n      metadata.latitude,\n      metadata.longitude,\n      this.state.position.latitude,\n      this.state.position.longitude\n    )\n    if (kmDistance > FORECAST_CACHE_KM) {\n      // Forecast from too far away, that's not current\n      return false\n    }\n\n    console.log(`Forecast considered current: ${ageMs}ms old and ${kmDistance}km away`)\n    return true\n  }\n\n  download_weather = () => {\n    const latitude = this.state.position.latitude\n    const longitude = this.state.position.longitude\n\n    this.setState({\n      progress: <text className='progress'>Downloading weather...</text>\n    })\n\n    const url = `https://api-met-no-proxy.appspot.com/weatherapi/locationforecast/1.9/?lat=${latitude};lon=${longitude}`\n    console.log('Getting weather from: ' + url)\n\n    const self = this\n\n    fetch(url)\n      .then(response => {\n        if (!response.ok) {\n          throw new Error(`Response code from upstream: ${response.status}`)\n        }\n        return response.text()\n      })\n      .then(weatherXmlString => {\n        const forecast = self.parseWeatherXml(weatherXmlString)\n\n        self.setState({\n          forecast: forecast,\n          forecastMetadata: {\n            // FIXME: Rather than the current timestamp, maybe track when yr.no\n            // thinks the next forecast will be available? That information is\n            // available in the XML.\n            timestamp: new Date(),\n            latitude: latitude,\n            longitude: longitude\n          }\n        })\n      })\n      .catch(error => {\n        this.setState({\n          error: (\n            <Error title='Downloading weather failed' reload={this.props.reload}>\n              {error.message}\n            </Error>\n          )\n        })\n      })\n  }\n\n  /* Parses weather XML from yr.no into a weather object that maps timestamps (in\n   * seconds since the epoch) to forecasts. A forecast has these fields:\n   *\n   * .celsius: The forecasted temperatures in centigrades\n   *\n   * .wind_m_s: The forecasted wind speed\n   *\n   * .symbol: The weather symbol index. Resolve using\n   *         https://api.yr.no/weatherapi/weathericon\n   */\n  parseWeatherXml = weatherXmlString => {\n    const weatherXml = new window.DOMParser().parseFromString(weatherXmlString, 'text/xml')\n    const allPrognoses = weatherXml.getElementsByTagName('time')\n    console.log('Parsing ' + allPrognoses.length + ' prognoses...')\n\n    const forecasts = {}\n    for (var i = 0; i < allPrognoses.length; i++) {\n      const prognosis = allPrognoses[i]\n\n      const from = new Date(prognosis.attributes.from.value)\n      const to = new Date(prognosis.attributes.to.value)\n      const dh = (to.getTime() - from.getTime()) / (3600 * 1000)\n      const timestamp = new Date((from.getTime() + to.getTime()) / 2)\n\n      var forecast = forecasts[timestamp]\n      if (!forecast) {\n        forecast = {}\n      }\n\n      forecast.timestamp = timestamp\n\n      if (forecast.span_h !== undefined && forecast.span_h <= dh) {\n        // There's already better data here\n        continue\n      }\n\n      forecast.span_h = dh\n\n      const symbolNodes = prognosis.getElementsByTagName('symbol')\n      if (symbolNodes && symbolNodes.length > 0) {\n        const symbolNumber = symbolNodes[0].attributes.number.value\n        forecast.symbol = symbolNumber\n      }\n\n      const celsiusNodes = prognosis.getElementsByTagName('temperature')\n      if (celsiusNodes && celsiusNodes.length > 0) {\n        const celsiusValue = celsiusNodes[0].attributes.value.value\n        forecast.celsius = parseFloat(celsiusValue)\n      }\n\n      const windNodes = prognosis.getElementsByTagName('windSpeed')\n      if (windNodes && windNodes.length > 0) {\n        const windValue = windNodes[0].attributes.mps.value\n        forecast.wind_m_s = parseFloat(windValue)\n      }\n\n      const precipitationNodes = prognosis.getElementsByTagName('precipitation')\n      if (precipitationNodes && precipitationNodes.length > 0) {\n        const precipitationValue = precipitationNodes[0].attributes.value.value\n        forecast.precipitation_mm = parseFloat(precipitationValue)\n      }\n\n      forecasts[timestamp] = forecast\n    }\n\n    return forecasts\n  }\n\n  geoError = error => {\n    console.log('Geolocation failed')\n    this.setState({\n      // FIXME: Add a report-problem link?\n      // FIXME: Make the error message text clickable and link it to a Google search\n      // Reload trickery from: https://stackoverflow.com/a/10840058/473672\n\n      // Note that at least on desktop Firefox 69.0 for Mac, this JS-triggered reload\n      // won't re-ask the positioning question, but if the user manually reloads that\n      // will re-ask the question.\n      error: (\n        <Error title={error.message} reload={window.location.reload.bind(window.location, [true])}>\n          If you are asked whether to allow the Weather Clock to know your current location, please\n          say \"yes\".\n        </Error>\n      )\n    })\n  }\n\n  renderHands = () => {\n    const nowCoords = new ClockCoordinates(this.state.now)\n\n    // FIXME: This doubles the center circle shadow, maybe draw\n    // the center circle once here to get us only one of those?\n    return (\n      <React.Fragment>\n        <Hand\n          width={2.5}\n          dx={nowCoords.hourDx(HOUR_HAND_LENGTH)}\n          dy={nowCoords.hourDy(HOUR_HAND_LENGTH)}\n        />\n        <Hand\n          width={2}\n          dx={nowCoords.minuteDx(MINUTE_HAND_LENGTH)}\n          dy={nowCoords.minuteDy(MINUTE_HAND_LENGTH)}\n        />\n      </React.Fragment>\n    )\n  }\n\n  render = () => {\n    return (\n      <React.Fragment>\n        <svg\n          id='weatherclock'\n          xmlns='http://www.w3.org/2000/svg'\n          version='1.1'\n          viewBox='-50 -50 100 100'\n        >\n          <image x='-50' y='-50' width='100' height='100' xlinkHref='clock-frame.png' />\n\n          {this.getClockContents()}\n        </svg>\n        {this.state.error}\n      </React.Fragment>\n    )\n  }\n\n  getClockContents = () => {\n    if (this.state.forecast) {\n      return (\n        <React.Fragment>\n          <Weather forecast={this.state.forecast} now={this.state.now} />\n          {this.renderHands()}\n        </React.Fragment>\n      )\n    }\n\n    if (this.state.error) {\n      // These hands will show up behind the error dialog\n      return this.renderHands()\n    }\n\n    if (this.state.progress) {\n      return this.state.progress\n    }\n\n    // Most likely the initial state\n    return null\n  }\n}\n\nClock.propTypes = {\n  now: PropTypes.instanceOf(Date).isRequired,\n  reload: PropTypes.func.isRequired\n}\n\nexport default Clock\n","import React from 'react'\nimport './App.css'\n\nimport Clock from './Clock.js'\n\nclass App extends React.Component {\n  state = {\n    now: new Date()\n  }\n\n  setTimeToNow = () => {\n    this.setState({\n      now: new Date()\n    })\n  }\n\n  render = () => {\n    return (\n      <div className='App'>\n        <Clock now={this.state.now} reload={this.setTimeToNow} />\n\n        {/*\n        If you add a Weatherclock launcher to your home screen on an iPhone,\n        the page opened will not be in a web-browser (or at least look like\n        it's not).\n\n        So we add a reload button of our own here.\n        */}\n        <button type='button' onClick={this.setTimeToNow}>\n          Update forecast\n        </button>\n\n        <p>\n          Weather forecast from <a href='yr.no'>yr.no</a>, delivered by the{' '}\n          <a href='https://met.no/English/'>Norwegian Meteorological Institute</a> and the{' '}\n          <a href='https://www.nrk.no/'>NRK</a>.\n        </p>\n\n        <p>Imagine a share-on-Facebook button here</p>\n\n        <p>\n          <a href='https://github.com/walles/weatherclock'>Source code on GitHub</a>\n        </p>\n      </div>\n    )\n  }\n}\n\nexport default App\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\n// Redirect to https, this helps with positioning in some circumstances\nconst protocol = window.location.protocol\nif (protocol === 'http:' && window.location.hostname !== 'localhost') {\n  // From http://stackoverflow.com/a/4723302/473672\n  window.location.href = 'https:' + window.location.href.substring(protocol.length)\n} else {\n  ReactDOM.render(<App />, document.getElementById('root'))\n\n  // If you want your app to work offline and load faster, you can change\n  // unregister() to register() below. Note this comes with some pitfalls.\n  // Learn more about service workers: https://bit.ly/CRA-PWA\n  serviceWorker.unregister()\n}\n"],"sourceRoot":""}